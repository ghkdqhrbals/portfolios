---
layout: default
title: ğŸ“Œ Saga íŒ¨í„´
parent: MSA
nav_order: 2
---
# SAGA
SAGA íŒ¨í„´ì€ MSAì—ì„œ íŠ¸ëœì ì…˜ì˜ ACIDë¥¼ ë³´ì¥í•˜ê¸°ìœ„í•´ ë§Œë“  íŒ¨í„´ì…ë‹ˆë‹¤. SAGAëŠ” ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë“¤ì´ ì—°ê²°ëœ ë°©ì‹ì— ë”°ë¼, ê´€ë¦¬ë¥¼ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•˜ëŠ”ì§€ì— ë”°ë¼ Orchestration/Choreography ì´ ë‘ ê°€ì§€ì˜ í˜•íƒœë¥¼ ê°€ì§‘ë‹ˆë‹¤.

## Orchestration í˜•íƒœ

|--|-|
|![Orchestration](../../../assets/img/msa/orche.png)| Orchestration í˜•íƒœëŠ” í”Œë¡œìš°ë¥¼ `composite` ì„œë¹„ìŠ¤ê°€ ì œì–´í•©ë‹ˆë‹¤. <br/> ì˜ˆë¥¼ ë“¤ì–´ë³¼ê¹Œìš”? <br/> ì”ì•¡ì„ ê°€ì ¸ì˜¤ëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œ `A`,`B`,`C` ì„œë¹„ìŠ¤ê°€ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰ë˜ì–´ì•¼ í•œë‹¤ê³  ê°€ì •í•´ë³´ê² ìŠµë‹ˆë‹¤. `composite` ì„œë¹„ìŠ¤ëŠ” `A`ì—ê²Œ ë¨¼ì € ìš”ì²­ì„ í•©ë‹ˆë‹¤. ì•„ë¬´ ì´ìƒì´ ì—†ì„ ë•Œ, `B`ì—ê²Œ ë‹¤ìŒ ìš”ì²­ì„ ì§„í–‰í•©ë‹ˆë‹¤. ì´ ë•Œ! `B`ê°€ ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? `composite` ì„œë¹„ìŠ¤ëŠ” `B`ì™€ `A`ì—ê²Œ ìˆœì°¨ì ìœ¼ë¡œ ë¡¤ë°±ì„ ìš”ì²­í•˜ê²Œ ë©ë‹ˆë‹¤. <br/> ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” í•œê°€ì§€ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°”ë¡œ `A`,`B`,`C`ì˜ ìš”ì²­ì— ëŒ€í•œ ë‹µë³€ì´ ì˜¬ ë•Œ ê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ ë‹¨ì ìœ¼ë¡œ ê·€ê²°ë©ë‹ˆë‹¤. ê¸°ëŠ¥ì— í•„ìš”í•œ ì„œë¹„ìŠ¤ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡, ë” ë§ì€ ì„œë¹„ìŠ¤ë¡œë¶€í„°ì˜ ë‹µë³€ì„ ê¸°ë‹¤ë ¤ì•¼ ëœë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì¦‰, ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ íŠ¸ëœì ì…˜ë“¤ì˜ ìˆœì„œë¥¼ ë³´ì¥í•˜ê¸° ìœ„í•´ì„œëŠ” ë”œë ˆì´ê°€ ë°œìƒí•  ìˆ˜ ë°–ì— ì—†ëŠ” ë‹¨ì ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. |


## Choreography í˜•íƒœ

|--|-|
|![Choreography](../../../assets/img/msa/chor.png)| ê·¸ë ‡ë‹¤ë©´ ChoreographyëŠ” Orchestrationì™€ ë¬´ì—‡ì´ ë‹¤ë¥¼ê¹Œìš”?<br/> ChoreographyëŠ” `composite` ì„œë¹„ìŠ¤ ì—†ì´, ê°ê°ì˜ ì„œë¹„ìŠ¤ê°€ ì´ë²¤íŠ¸ ë¸Œë¡œì»¤ë¥¼ í†µí•´ì„œ ì„œë¡œì—ê²Œ ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì–´ë–»ê²Œ ë³´ë©´ ì–˜ë„ ë§ˆì°¬ê°€ì§€ë¡œ íŠ¸ë Œì ì…˜ ìˆœì„œë¥¼ ë³´ì¥í•¨ì— ë”°ë¼(ë©”ì„¸ì§€ ì „ì†¡ ìˆœì„œì— ë”°ë¼) ë”œë ˆì´ë¥¼ ê°€ì§ˆ ìˆ˜ ë°–ì— ì—†ê¸´ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ Choreography í˜•íƒœëŠ” ë©”ì„¸ì§€ ë¸Œë¡œì»¤ë¥¼ í†µí•´ **ê°„ì ‘ì ìœ¼ë¡œ ë©”ì„¸ì§€ë¥¼ ì£¼ê³ ë°›ê¸°ë•Œë¬¸ì—, ì„œë¹„ìŠ¤ ê°„ ë””ì»¤í”Œë§ ì •ë„ê°€ ë†’ë‹¤**ë¼ëŠ” ì¸¡ë©´ì—ì„œ ì¥ì ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. |

ìœ„ì˜ ë‚´ìš©ë“¤ê³¼ ê°™ì´ Orchestration ì¥ì ê³¼ ë‹¨ì ì„ Choreographyì™€ ë¹„êµí•˜ë©° ë‹¤ìŒê³¼ ê°™ì´ ì •ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

* Orchestration ì¥ì 
  * **ì‰¬ìš´ ëª¨ë‹ˆí„°ë§** : `composite` ì„œë¹„ìŠ¤ í•œêµ°ë°ì—ì„œ ì„œë¹„ìŠ¤ ìˆœì„œë¥¼ ê´€ë¦¬í•¨ì— ë”°ë¼ ìš”ì²­ë°›ì€ ê¸°ëŠ¥ìˆ˜í–‰ì„ ìœ„í•œ ì§„í–‰ë‹¨ê³„ë¥¼ ì‰½ê²Œ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  > ì˜ˆë¡œ Choreographyí˜•íƒœëŠ” ì§€ê¸ˆ ì–´ë””ê¹Œì§€ ì§„í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì‚¬ìš©í•˜ëŠ” í† í”½ì„ í•˜ë‚˜í•˜ë‚˜ ë‹¤ ê´€ì°°í•´ì•¼í•©ë‹ˆë‹¤. ë°˜ë©´ì— `Orchestration` í˜•íƒœì—ì„œëŠ” `composite` ì„œë¹„ìŠ¤ë§Œ ê´€ì°°í•˜ë©´ ì‰½ê²Œ ë³¼ ìˆ˜ ìˆì£ .
  * **ìœ ì§€/ë³´ìˆ˜ ë¹„ìš© ì¸¡ë©´**
  > ë§Œì•½ `A`,`B`,`C` ì„œë¹„ìŠ¤ ë‹¤ìŒì— `D` ì„œë¹„ìŠ¤ê°€ ìˆ˜í–‰ë˜ë„ë¡ ë³´ìˆ˜í•œë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤. `composite` ì„œë¹„ìŠ¤ì— `D` ì„œë¹„ìŠ¤ë§Œ ì¶”ê°€í•´ì£¼ë©´ ì‰½ê²Œ í™•ì¥ì‹œí‚¬ ìˆ˜ ìˆì£ .
  >
  > ë°˜ë©´ Choreographyí˜•íƒœëŠ” ì–´ë–¤ ë©´ìœ¼ë¡œëŠ” ìœ ì§€/ë³´ìˆ˜í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.
  >
  > Choreographyí˜•íƒœëŠ” ë§ˆì§€ë§‰ì— `D` ì„œë¹„ìŠ¤ë¥¼ ë¶™ì´ê³  ì‹¶ì„ ë•Œ ë‹¤ìŒì˜ ê³¼ì •ì„ ìˆ˜í–‰í•˜ê²Œ ë©ë‹ˆë‹¤. (1) ì—°ê²°ëœ ì„œë¹„ìŠ¤ë“¤ì„ íƒ€ê³ íƒ€ê³  ë“¤ì–´ê°€ë©´ì„œ ì„œë¹„ìŠ¤ ì§„í–‰ ë°©í–¥ì„ íŒŒì•…í•©ë‹ˆë‹¤. (2) ì´ ê³¼ì •ì—ì„œ `A`->`B`->`C`ë¡œ ì§„í–‰ë°©í–¥ì„ íŒŒì•…í•˜ê³ , `C` ì„œë¹„ìŠ¤ì— ì‹¤ì œë¡œ `D` ì„œë¹„ìŠ¤ë¥¼ ë¶™ì´ê²Œ ë©ë‹ˆë‹¤.
  >
  > ì¦‰, Choreographyí˜•íƒœëŠ” (1)ì˜ ê³¼ì •ì´ ì„ í–‰ë˜ì–´ì•¼ í•˜ë©°, ì–´ë–¤ì‹ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ì—°ê²°ë˜ì—ˆëŠ”ì§€ ì„œë¹„ìŠ¤ í•˜ë‚˜í•˜ë‚˜ ê¹Œë³´ì•„ì•¼ ëœë‹¤ëŠ” ì ì´ ìœ ì§€/ë³´ìˆ˜ë¥¼ ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ë˜í•œ ìì‹ ì—ê²Œ í•„ìš”í•œ ì´ë²¤íŠ¸ë¥¼ êµ¬ë…í•´ì•¼ í•˜ë¯€ë¡œ ì–´ë–¤ ì„œë¹„ìŠ¤ì—ì„œ ì–´ë–¤ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•˜ëŠ”ì§€ ë¯¸ë¦¬ ì•Œì•„ì•¼ í•œë‹¤ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤.
  >
  > ê·¸ë ‡ì§€ë§Œ ì´ë²¤íŠ¸ í† í”½ ë³„ ê¸°ëŠ¥ ë° ì„œë¹„ìŠ¤ë“¤ì´ ì˜ ë¬¸ì„œí™”ë˜ì–´ ìˆë‹¤ë©´, **ì˜¤íˆë ¤ Orchestrationí˜•íƒœê°€ Choreographyì— ë¹„í•´ ìœ ì§€/ë³´ìˆ˜ ë¹„ìš©ì´ ë†’ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤**!

* Orchestration ë‹¨ì 
  * **íƒ€ì´íŠ¸í•œ ì»¤í”Œë§** : Orchestration í˜•íƒœì—ì„œëŠ” ëª¨ë“  ì„œë¹„ìŠ¤ë“¤ì´ `composite` ì„œë¹„ìŠ¤ì™€ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.ì¦‰, `composite` ì„œë¹„ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ, ëª¨ë“  ì„œë¹„ìŠ¤ë“¤ì´ ì˜í–¥ì„ ë°›ê²Œ ë˜ì–´ ì—ëŸ¬ë°œìƒì˜ ì›ì¸ì´ ë©ë‹ˆë‹¤. ë˜í•œ ì§ì ‘ì ìœ¼ë¡œ ì„œë¡œ í†µì‹ í•˜ê¸°ì—, **í™•ì¥ì„±ì— ìˆì–´ ë¶ˆë¦¬í•©ë‹ˆë‹¤**. 
  > ì´ ë¶€ë¶„ì€ Choreographyì˜ ì¥ì ìœ¼ë¡œ ì—°ê²°ë©ë‹ˆë‹¤.
  

# References
* [https://waspro.tistory.com/735](https://waspro.tistory.com/735)
* [https://microservices.io/patterns/data/saga.html](https://microservices.io/patterns/data/saga.html)
* [https://stackoverflow.com/questions/4127241/orchestration-vs-choreography](https://stackoverflow.com/questions/4127241/orchestration-vs-choreography)
* [https://solace.com/blog/microservices-choreography-vs-orchestration/](https://solace.com/blog/microservices-choreography-vs-orchestration/)
* [https://blog.bitsrc.io/how-to-use-saga-pattern-in-microservices-9eaadde79748](https://blog.bitsrc.io/how-to-use-saga-pattern-in-microservices-9eaadde79748)
* [https://chobowarrior.tistory.com/49](https://chobowarrior.tistory.com/49)