---
layout: default
title: Kotlin ì¡ë™ì‚¬ë‹ˆ
date: 2024-09-06
parent: ğŸ“Œ Server
nav_order: 19
---

created at 2024-09-06
{: .label .label-yellow }

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

### kotlin init ë¸”ë¡ ì‹¤í–‰ ìˆœì„œ

```kotlin
data class Response(
  val ci: String?,
) {
    
  init {
    ci = ci?:"hashed"
  }

  constructor(name: String, age: Int) : this(name) {
    println("Secondary constructor: Age is $age")
  }
}
```

1. ê°ì²´ ìƒì„± ë° í•„ë“œ ì£¼ì…
2. init ë¸”ë¡ ì‹¤í–‰
   * í•„ë“œ ê°’ì´ ëª¨ë‘ ì£¼ì…ëœ í›„ì—, init ë¸”ë¡ì´ ì‹¤í–‰
   * init ë¸”ë¡ì€ ìƒì„±ì í˜¸ì¶œì´ ëë‚œ ì§í›„ ì‹¤í–‰ë˜ë©°, ì´ ì‹œì ì—ì„œ ì´ë¯¸ ëª¨ë“  íŒŒë¼ë¯¸í„°ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ” ìƒíƒœ 

### kotlin sequence


ì¼ë°˜

![im](/portfolios/assets/img_5.png)

ì‹œí€€ìŠ¤

![im](/portfolios/assets/img_6.png)


```kotlin
import kotlin.system.measureTimeMillis

class User(val name: String, val age: Int)

fun createRandomUser(): User {
   return User("User${(Math.random() * 100).toInt()}", (Math.random() * 100).toInt())
}

fun checkHeap(label: String, previousUsedMemory: Long): Long {
   val runtime = Runtime.getRuntime()
   val usedMemory = runtime.totalMemory() - runtime.freeMemory()
   val memoryIncrease = usedMemory - previousUsedMemory
   println("$label - Used Memory: $usedMemory bytes (Increased: ${memoryIncrease} bytes)")
   return usedMemory
}

fun t1(users: List<User>): List<String> {
   println("Starting t1...")
   val initialMemory = getHeapMemory()
   var previousUsedMemory = initialMemory

   val result = measureTimeMillis {
      val filtered = users.filter { it.age % 2 == 0 } // ì¤‘ê°„ ì»¬ë ‰ì…˜ ìƒì„±
      previousUsedMemory = checkHeap("After filter in t1", previousUsedMemory)

      val mapped = filtered.map { it.name } // ë˜ ë‹¤ë¥¸ ì¤‘ê°„ ì»¬ë ‰ì…˜ ìƒì„±
      previousUsedMemory = checkHeap("After map in t1", previousUsedMemory)

      println("Total Memory Increase in t1: ${previousUsedMemory - initialMemory} bytes")
      return mapped
   }
   println("t1 Execution Time: $result ms")
}

fun getHeapMemory(): Long{
   val runtime = Runtime.getRuntime()
   return runtime.totalMemory() - runtime.freeMemory()
}
fun t2(users: List<User>): List<String> {
   println("\nStarting t2...")
   val initialMemory = getHeapMemory()
   var previousUsedMemory = initialMemory

   val result = measureTimeMillis {
      val sequence = users.asSequence().filter { it.age % 2 == 0 } // ì§€ì—° í‰ê°€, ì¤‘ê°„ ì»¬ë ‰ì…˜ ì—†ìŒ
      previousUsedMemory = checkHeap("After filter in t2", previousUsedMemory)

      val mapped = sequence.map { it.name } // ì—¬ì „íˆ ì¤‘ê°„ ì»¬ë ‰ì…˜ ì—†ìŒ
      previousUsedMemory = checkHeap("After map in t2", previousUsedMemory)

      val resultList = mapped.toList() // ì´ ë•Œ ëª¨ë“  ì—°ì‚° ìˆ˜í–‰
      previousUsedMemory = checkHeap("After toList in t2", previousUsedMemory)

      println("Total Memory Increase in t2: ${previousUsedMemory - initialMemory} bytes")
      return resultList
   }
   println("t2 Execution Time: $result ms")
}

fun main() {
   // í° ë¦¬ìŠ¤íŠ¸ ìƒì„±
   val users = List(1_000_000) { createRandomUser() }

   t1(users)
   t2(users)
}
```


```bash
Starting t1...
After filter in t1 - Used Memory: 91721368 bytes (Increased: 6229824 bytes)
After map in t1 - Used Memory: 94891576 bytes (Increased: 3170208 bytes)
Total Memory Increase in t1: 9400032 bytes

Starting t2...
After filter in t2 - Used Memory: 94891576 bytes (Increased: 0 bytes)
After map in t2 - Used Memory: 94891576 bytes (Increased: 0 bytes)
After toList in t2 - Used Memory: 101846240 bytes (Increased: 6954664 bytes)
Total Memory Increase in t2: 6954664 bytes
```

ì‹¤ì œë¡œ ì‹¤í—˜ ê²°ê³¼ ì¤‘ê°„ ê²°ê³¼ê°’ì„ ì €ì¥. sequence ëŠ” lazy í•˜ë©° í•œí˜¸í¡ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸°ë•Œë¬¸ì— ì¤‘ê°„ ì»¬ë ‰ì…˜ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤. (intellij ì—ì„œ profiler ë¡œ ì‰½ê²Œ í™•ì¸ê°€ëŠ¥!)

ì¦‰, ì»¬ë ‰ì…˜ í¬ê¸°ê°€ í¬ë©° filtering ì´í›„ í›„ì²˜ë¦¬ ë” í•„ìš”í•˜ë‹¤ë©´ sequence ë¡œ ì²˜ë¦¬í•˜ëŠ”ê²Œ ì¢‹ì„ë“¯. íŠ¹íˆ `.take(...)` ì“°ê²Œ ëœë‹¤ë©´ stream ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” sequence ê°€ ë‹¹ì—° ë¹ ë¥´ë‹¤. 

ë§Œì•½ í›„ì¹˜ëŸ¬ í•˜ì§€ ì•Šê±°ë‚˜ ì»¬ë ‰ì…˜ í¬ê¸°ê°€ ì‘ë‹¤ë©´ ì¼ë°˜ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ë” ì¢‹ì„ë“¯. ì¶”ê°€ lazy ë¥¼ ìœ„í•œ ë°”ì´íŠ¸ê°€ ë” ë“¤ì–´ê°€ê¸°ë•Œë¬¸ì— ì˜¤íˆë ¤ ë©”ëª¨ë¦¬ë¥¼ ë” ë¨¹ì„ ìˆ˜ê°€ ìˆìŒ.

### OffsetDateTime ì‚¬ìš© ì‹œ equals or isBefore ì— ëŒ€í•œ ë‘ ê°€ì§€ ë°©ë²•

```kotlin
if (date1.before(date2) || date1.equals(date2)) {
    // ë°”ë¡œ ì´í•´í•˜ê¸° ì‰¬ì›€
}

if (!date1.isAfter(date2)) {
   // ì§§ì§€ë§Œ ë°”ë¡œ ì´í•´í•˜ê¸° ì–´ë ¤ì›Œì„œ ì•ˆì“¸ë“¯?
}
```