---
layout: default
title: RestClient íƒ„ìƒ ë¹„í™”
date: 2025-01-28
parent: ğŸ“Œ Server
nav_order: 27
---

created at 2025-01-28
{: .label .label-yellow }

## Table of contents
{: .no_toc .text-delta }

1. TOC
{:toc}

### sync/blocking í•˜ëŠ” restTemplate deprecated í•˜ê³  async/non-blocking í•˜ëŠ” webClient ë¡œ ì™„ë²½ì´ì „ í•˜ë ¤ê³  í–ˆìœ¼ë‚˜ ì¤‘ê°„ë‹¤ë¦¬ê°€ í•„ìš”í•¨
   
ì•„ë˜ì˜ discussion ì—ì„œ restClient ê°€ ì™œ ë‚˜ì™”ëŠ”ì§€ discussion ì´ ìˆì–´ì„œ ì •ë¦¬í•´ë´„.
> Reference: [https://github.com/spring-projects/spring-framework/issues/29552](https://github.com/spring-projects/spring-framework/issues/29552)

1. Spring 5.0 ë‚˜ì˜¤ë©´ì„œ async/non-blocking í’€ ì¥ì°©í•œ NIO ë¦¬ì—‘í„° ê¸°ë°˜ì˜ WebClient ê°€ ë‚˜ì˜´. ê·¸ë¦¬ê³  Spring 6.1 ì— restTemplate ì—ì„œ webClient ë¡œ ì™„ë²½ì´ì „ í• ë ¤ê³ í•¨.
2. ì´ê²ƒì˜ ì „ì œê°€ Java Project Loom ê°€ìƒ ìŠ¤ë ˆë“œ ê¸°ë°˜ì˜ async/non-blocking í’€ ì§€ì›ì„. ê·¸ëŸ°ë° ì´ê²Œ ì–´ë–¤ êµ¬ì¡°ë¡œ ë³‘ë ¬ì„±ì„ ì§€ì›í•  ì§€ ëª¨ë¦„. Spring íŒ€ì—ì„œ ë³´ê¸°ì— Project Loom ì´ ì •ì°©í• ë ¤ë©´ ê½¤ ë§ì€ ì‹œê°„ì´ ì†Œëª¨ë  ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤ê³  íŒë‹¨. DB async ë„ ì§€ì›í•´ì•¼ë˜ê³  ë”°ë¼ì„œ restTemplate ë¥¼ deprecated ì‹œí‚¤ê¸°ì—” ì•„ì§ ì´ë¥´ë‹¤ê³  íŒë‹¨í•¨. + async/non-blocking ì„ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ëŠ” ê²½ìš°ê°€ ìˆëŠ”ë° webClient ëŠ” ì´ë¥¼ ê°•ìš”í•˜ëŠ” ë“¯í•œ ì¸í„°í˜ì´ìŠ¤ì„.
3. ê·¸ë˜ì„œ restTemplate ì˜ ì‰¬ìš´ blocking ì¸í„°í˜ì´ìŠ¤ë¥¼ default ë¡œ ê³„ì† ì‚¬ìš©í•˜ë˜, WebClient ë¥¼ ê°„ì ‘ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œë” í•˜ë ¤ê³  í•¨. ì´ê²ƒì´ **restClient** ì„. fully async/non-blocking ê³¼ sync/blocking ì˜ ì¤‘ê°„ ì—°ê²°ë‹¤ë¦¬ ëŠë‚Œ.

RestClient ì˜ Rest prefix ëŠ” RESTful API ë¥¼ ì§€ì¹­í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, restTemplate ì˜ ê³„ë³´ë¥¼ ì‡ëŠ”ë‹¤ëŠ” ëŠë‚Œìœ¼ë¡œ rest prefix ë¥¼ ë¶™ì˜€ë‹¤ê³  í•¨. 
 
ì‚¬ì‹¤ restTemplate ë˜í•œ restful API ë¥¼ ì§€ì¹­í•˜ëŠ”ê²Œ ì•„ë‹ˆê¸´í•¨. ê·¸ëƒ¥ ì´ë¦„ì´ ê·¸ë ‡ê²Œ ì§€ì–´ì§„ ê²ƒì¼ ë¿. [poutsma](https://github.com/poutsma) ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ì‚¬ëŒë“¤ë„ ì´ ì˜ëª» ì§€ì–´ì§„ ì´ë¦„ì— ì‹ ê²½ì´ ì“°ì¸ë‹¤ê³  í•¨. ì•„ë§ˆ ë˜ëŒì•„ê°€ë©´ rest ë¼ëŠ” prefix ë¥¼ ì—†ì• ë²„ë¦¬ì§€ ì•Šì„ê¹Œ ìƒê°í•¨.

interceptor, exception, error handler, retry, ... ë“±ë“± restTemplate ì—ì„œ ì‚¬ìš©í•˜ë˜ ê¸°ëŠ¥ë“¤ì„ restClient ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ. ê·¸ë¦¬ê³  ë˜ê²Œ ì‰½ê²Œ restTemplate ì—ì„œ restClient ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ í•  ìˆ˜ ìˆìŒ.

```kotlin
    @Bean(name = ["paymentRestTemplate"])
    fun paymentRestTemplate(): RestTemplate {
        val requestFactory = SimpleClientHttpRequestFactory()
        requestFactory.setConnectTimeout(3 * 1000)
        requestFactory.setReadTimeout(30 * 1000)

        return RestTemplateBuilder()
            .setConnectTimeout(Duration.ofMillis(3 * 1000))
            .setReadTimeout(Duration.ofMillis(30 * 1000))
            .requestFactory { _ ->
                BufferingClientHttpRequestFactory(requestFactory)
            }
            .interceptors(consoleLogApiCallInterceptor)
            .build()
    }

    @Bean(name = ["paymentRestClient"])
    fun paymentRestClient(): RestClient {
        val requestFactory = SimpleClientHttpRequestFactory()
        requestFactory.setConnectTimeout(3 * 1000)
        requestFactory.setReadTimeout(30 * 1000)
    
        return RestClient.builder()
            .requestFactory(requestFactory)
            .requestInterceptor(restClientConsoleLogApiCallInterceptor)
            .messageConverters { converters ->
                converters.removeIf { it is MappingJackson2HttpMessageConverter }
                converters.add(customJacksonMessageConverter)
            }
            .build()
    }
```

ë³´ë©´ converter, interceptor, requestFactory ë“±ë“± restTemplate ì—ì„œ ì‚¬ìš©í•˜ë˜ ê²ƒë“¤ì„ restClient ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ. ê·¸ë¦¬ê³  restClient ëŠ” restTemplate ë¥¼ ìƒì†ë°›ì•„ì„œ ë§Œë“¤ì–´ì¡Œê¸° ë•Œë¬¸ì— restTemplate ì—ì„œ ì‚¬ìš©í•˜ë˜ ê²ƒë“¤ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.

> With RestClient we are introducing a HTTP client that offers an API similar to WebClient, and that uses the message converters, request factories, interceptors, and other underlying components of RestTemplate.
> 
> reference : [https://spring.io/blog/2023/07/13/new-in-spring-6-1-restclient](https://spring.io/blog/2023/07/13/new-in-spring-6-1-restclient)
> 
> ì§„ì§œ ìœ„ì˜ ë˜í¼ì— ì–˜ë„¤ê°€ ë§í•œëŒ€ë¡œ restTemplate ì˜ request factories, interceptor, etc. ê·¸ëŒ€ë¡œ ì“¸ ìˆ˜ ìˆìœ¼ë©´ì„œë„ webClient ì™€ ë¹„ìŠ·í•œ async/non-blocking ê°„ì ‘ì²´í—˜ ê°€ëŠ¥. ê±°ê¸°ì— spring-boot-starter-webflux ëŠ” í•„ìš”ì—†ë„ë¡ êµ¬ì„±í–ˆë‹¤ê³  í•¨. 