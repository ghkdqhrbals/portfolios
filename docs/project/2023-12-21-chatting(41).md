---
layout: default
title: 41. ì„œë²„ ì„±ëŠ¥ ê°œì„  ê¸°ë¡ - TPS 185%, MTTFB 68% ì„±ëŠ¥ ì¦ê°€
parent: ğŸ“Œ ì‹¤ì‹œê°„ ì±„íŒ…ì„œë²„ í”„ë¡œì íŠ¸
nav_order: 41
---

created at 2023-12-21
{: .label .label-yellow }

> ë³¸ í¬ìŠ¤íŒ…ì€ ì œê°€ Git issues ì— ì‘ì„±í–ˆë˜ ê¸€ì„ ê°€ì ¸ì˜¨ ê²ƒì…ë‹ˆë‹¤! ìì„¸í•œ ë‚´ìš©ë“¤ì€ [Git issues](https://github.com/ghkdqhrbals/spring-chatting-server/issues) ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ì‡ì–´ìš”.

ê·¸ë¦¬ê³  ngrinder ì„ í†µí•œ csv íŒŒì¼ë¡œë¶€í„° MTTFB í‰ê· ê³¼ ë³€ë™ëŸ‰, ë³€ë™ë¥  ì¸¡ì •í•˜ëŠ” python ì½”ë“œëŠ” í¬ìŠ¤íŒ… ë§¨ ì•„ë˜ì— ìˆìŠµë‹ˆë‹¤!


### ì„œë²„ ë¡œë“œ í…ŒìŠ¤íŠ¸ í™˜ê²½
* Thread : 296
* URL : GET /rooms
* Duration : 10min
* Test-Server ìŠ¤í™
  * CPU : 8 virtual core
  * Memory : 32GB
  * OS : MacOS Big Sur
* Target-Server EC2 ì¸ìŠ¤í„´ìŠ¤ ìŠ¤í™
  * Instance Type: t3.medium 
  * CPU : 2 virtual core
  * Memory : 8GB
  * OS : Ubuntu 20.04.3 LTS

### 1. HPA ë¥¼ í†µí•œ íŒŒë“œ ì˜¤í†  ìŠ¤ì¼€ì¼ë§ ì ìš© ì‹œ ê²°ê³¼

* ê²°ê³¼
  * Total Test : 142,805
  * Success : 133,416
  * Error : 9,389 (6.6%)
  * AVG TPS : 226.1
  * MTTFB í‰ê· : 1265.08 ms 
  * MTTFB ì°¨ì´ í‰ê·  : 1020.87 ms 
  * MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): 86.83%
* í…ŒìŠ¤íŠ¸ ì§€í‘œ í™•ì¸ ë° ê°œì„ ì 

    <img width="970" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/4ea4c027-34f7-4293-95e2-b7799382bede">
    
    ì¤‘ê°„ì¤‘ê°„ TPS ê°€ ê°ì†Œí•˜ëŠ” ëª¨ìŠµì„ í™• ìœ„ì˜ ê·¸ë˜í”„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—­ì‹œ VUSER ê°€ 100ëª…ì¼ ë•Œì™€ 300ì¼ ë•ŒëŠ” ë§ì´ ë‹¤ë¥´ë„¤ìš” :( TPS ê°ì†Œ ì´ìœ ëŠ” ì•„ë˜ì˜ ê·¸ë˜í”„ì—ì„œ ì›ì¸ì„ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    <img width="975" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/80d42111-f3d2-4318-913c-5d436d86afee">
    
    <img width="974" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/ece440d4-52c1-4c01-93b5-8db783a7e33d">
    
    MTTFB ê°€ ì¤‘ê°„ì¤‘ê°„ 5ì´ˆê°€ ë„˜ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ° í”¼í¬ë¥¼ ë³´ì¼ ë•Œ ë§ˆë‹¤ ì˜¤ë¥˜ë˜í•œ ì¦ê°€í•©ë‹ˆë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ TPS ë˜í•œ ê°™ì´ ê°ì†Œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì €ëŠ” ì±„íŒ…ì„œë²„ì˜ ë¡œë“œê°€ ì¤‘ê°„ì¤‘ê°„ ì¦ê°€í•´ì„œ í—¬ìŠ¤ì²´í¬ì˜ íƒ€ì„ì•„ì›ƒì´ ë°œìƒí–ˆê³ , ì„œë¹„ìŠ¤ê°€ ë¡œë“œë°¸ëŸ°ì‹±ì„ ë‹¤ì‹œ ìˆ˜í–‰í•˜ë©´ì„œ  TPS ê°€ ê°ì†Œí–ˆë‹¤ê³  ìƒê°í–ˆì–´ìš”. í•œë²ˆ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.
    > ì±„íŒ…ì„œë²„ì˜ Deployment ì˜ readinessProbe í—¬ìŠ¤ì²´í¬ timeoutSecondsëŠ” 1ì´ˆë¡œ ì„¤ì •ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤.
    
    <img width="1440" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/54e51317-0a91-4457-bf15-626b4e729964">
    
    deploy ë¡œê·¸ë¥¼ í™•ì¸í–ˆë”ë‹ˆ ì—­ì‹œ health íƒ€ì„ì•„ì›ƒ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì—ˆìŠµë‹ˆë‹¤.
    
    ê·¸ë ‡ë‹¤ë©´ íƒ€ì„ì•„ì›ƒì„ 10ì´ˆë¡œ ì„¤ì •í•˜ë©´ ê²¬ë”œ ìˆ˜ ìˆê² ì£ ?

### 2. Readiness íƒ€ì„ì•„ì›ƒ 1ì´ˆ -> 10ì´ˆ
* ê²°ê³¼
  * Total Test : 135,675
  * Success : 125,972
  * Error : 9,703 (7.1%)
  * AVG TPS : 213.4 
  * MTTFB í‰ê· : 1296.50 ms 
  * MTTFB ì°¨ì´ í‰ê·  : 1166.17 ms 
  * MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): 54.85%
* í…ŒìŠ¤íŠ¸ ì§€í‘œ í™•ì¸ ë° ê°œì„ ì 

    Readiness.timeout 10 ì´ˆë¡œ ì„¤ì •í•´ë„ í° ì°¨ì´ê°€ ì—†ì—ˆìŠµë‹ˆë‹¤ ã…œã…œ.
    > ì¡°ê¸ˆì˜ ì°¨ì´ì ì´ë¼ë©´ ë¹ˆë²ˆí•˜ê²Œ ë°œìƒí•˜ë˜ í—¬ìŠ¤ì²´í¬ íƒ€ì„ì•„ì›ƒ ë¬¸ì œê°€ ì¡°ê¸ˆì€ ì™„í™”ë˜ì—ˆë‹¤ëŠ” ì ì´ ì¡´ì¬í–ˆì–´ìš”.
    
    ì¤‘ê°„ì¤‘ê°„ TPS ê°€ ê°ì†Œí•˜ëŠ” ì˜¤ë¥˜ë˜í•œ ì—¬ì „íˆ ì¡´ì¬í–ˆìŠµë‹ˆë‹¤.
    
    <img width="969" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-12-19 á„‹á…©á„Œá…¥á†« 10 16 09" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/532fc934-67b2-473f-a1b1-06b50373114b">

### 3. Readiness íƒ€ì„ì•„ì›ƒ 10ì´ˆ -> 60ì´ˆ

* ê²°ê³¼
  * Total Test : 138,487
  * Success : 138,462
  * Error : 25 (0.0%)
  * AVG TPS : 233.3
  * MTTFB í‰ê· : 1224.22 ms 
  * MTTFB ì°¨ì´ í‰ê·  : 437.17 ms 
  * MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): 35.20%
* í…ŒìŠ¤íŠ¸ ì§€í‘œ í™•ì¸ ë° ê°œì„ ì 

    ì—¬ì „íˆ ì¤‘ê°„ì¤‘ê°„ MTTFB í”¼í¬ê°€ ê±°ì˜ **4000ms** ë¡œ ì¹˜ì†Ÿìœ¼ë©´ì„œ ì„œë²„ê°€ ì•ˆì •ì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì£ ? ê·¸ë¦¬ê³  ì´ì— ë§ì¶”ì–´ TPS ë˜í•œ ë–¨ì–´ì§€ê³ , ì˜¤ë¥˜ë„ ì¤‘ê°„ì— ë°œìƒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    ê·¸ë˜ë„ Error ëŠ” 0.0% ë¡œ ë¹„êµì  ì—ëŸ¬ì—†ì´ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë˜í•œ MTTFB ì˜ ë³€ë™ëŸ‰ í‰ê· ì´ ë§ì´ ë‚´ë ¤ê°„ ê±¸ í™•ì¸í•  ìˆ˜ ìˆì—ˆì–´ìš”. TPS ëŠ” ì—¬ì „íˆ ë‚®ê³  MTTFB ë˜í•œ ë¶ˆì•ˆì •í•˜ì§€ë§Œìš”!
    
    <img width="969" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/8b54019a-200b-4541-80d8-e31d3f15616b">
    
    <img width="967" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/b7b87c6a-dc44-44cc-b9fa-2e39def4c145">

## 4. ë‚´ì¥ tomcat 10.1.7v max-threads í¬ê¸° 10ê°œ -> 100ê°œ

ê·¸ë ‡ë‹¤ë©´ ì´ë²ˆì—” Spring boot ë‚´ì¥ í†°ì¼“ ì„œë²„ì˜ max-threads-size ë¥¼ ëŠ˜ë ¤ë´…ì‹œë‹¤. ì´ìœ ëŠ” ì±„íŒ…ì„œë²„ì˜ cpu ì‚¬ìš©ëŸ‰ì´ ìƒê°ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë§ì€ ìŠ¤ë ˆë“œë¥¼ ëŒë¦¬ê±°ë‚˜ ìš”ì²­ì„ ë§ì´ ë°›ì„ ìˆ˜ ìˆì–´ì•¼ì§€ cpu ì‚¬ìš©ë¥ ë„ ì˜¬ë¼ê°€ë‹ˆ ì´ ë¶€ë¶„ì— ë¬¸ì œê°€ ìˆë‹¤ê³  íŒë‹¨í•˜ê³  ìŠ¤ë ˆë“œ í’€ ì‚¬ì´ì¦ˆë¥¼ ëŠ˜ë¦¬ëŠ” ë°©í–¥ì„ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

* ê²°ê³¼
  * Total Test : 134,988
  * Success : 134,953
  * Error : 35(0.0%)
  * AVG TPS : 228.4
  * MTTFB í‰ê· : 1249.87 ms
  * MTTFB ì°¨ì´ í‰ê·  : 350.82 ms
  * MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): 24.47%

<img width="971" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/36d9b254-6940-440d-a740-f4d2a769b296">

MTTFB ì˜ ë³€ë™ ì°¨ì´ í‰ê· ì´ ë‚®ì•„ì¡ŒìŠµë‹ˆë‹¤. ì´ì— ë”°ë¼ í‰ê·  ë³€ë™ë¥ ë˜í•œ ë‚´ë ¤ê°”ìŠµë‹ˆë‹¤. ì¡°ê¸ˆ ë” ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ê°€ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê±°ê² ì£ ?

ì•„ì§ ìƒê°ë³´ë‹¤ **cpu ë¦¬ì†ŒìŠ¤ë¥¼ ì œëŒ€ë¡œ í™œìš©í•˜ì§€ ëª»í•˜ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤**. ë¹¨ê°„ì„ ì€ request ì´ë©° ë…¸ë€ì„ ì€ limit ì…ë‹ˆë‹¤. y-grid ëŠ” 0.5 cpu ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
> ë¬¼ë¡  I/O ì‘ì—…ì´ ë§ì€ ì±„íŒ…ì„œë²„ì˜ ê²½ìš° cpu ì‚¬ìš©ëŸ‰ì´ ë§ì´ ì¦ê°€í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ ë¶€ë¶„ì€ ë” ê³ ë¯¼í•´ë´ì•¼í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤. 

<img width="874" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/1ead65ee-dd04-46d9-a4a1-267be519a83c">

### (Appendix) VUSER 300 ëª… ì¼ ë•Œ ë‹¨ì¼ ì±„íŒ…ì„œë²„ íŒŒë“œë¡œ í•¸ë“¤ë§ ì‹œ ê²°ê³¼

ë§Œì•½ vuser 300 ëª…ì„ HPA íŒŒë“œ ì˜¤í†  ìŠ¤ì¼€ì¼ ì•„ì›ƒ ì—†ì´ ë‹¨ì¼ íŒŒë“œë¡œë§Œ í•¸ë“¤ë§í•  ë•Œ ì–´ë–¤ ê²°ê³¼ê°€ ë‚˜ì˜¬ì§€ ê¶ê¸ˆí•˜ì§€ ì•Šë‚˜ìš”?

ê·¸ë˜ì„œ ì‹¤í—˜í•´ë³´ì•˜ê³  ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤. ì‹¤í—˜ ì¤‘ ì˜¤ë¥˜ê°€ ë„ˆë¬´ ë§ì´ ë°œìƒë˜ì„œ ìë™ìœ¼ë¡œ ì¤‘ì§€ë  ì •ë„ë¡œ ë§ì€ ì˜¤ë¥˜ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

* ê²°ê³¼
  * Total Test : 40,228
  * Success : 19,668
  * Error : 20,560 (51.1%)
  * AVG TPS : 108.1
  * MTTFB í‰ê· : 1605.44 ms 
  * MTTFB ì°¨ì´ í‰ê·  : 2838.38 ms 
  * MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): 75.00%

ì—„ì²­ë‚˜ì£ ? MTTFB í‰ê· ê°’ì´ ë†’ì•„ì¡Œìœ¼ë©° ì—ëŸ¬ë¥ ë˜í•œ 50% ì´ìƒì„ ê¸°ë¡í•©ë‹ˆë‹¤. ë˜í•œ MTTFB ì°¨ì´ í‰ê· ì´ ì•½ 3ì´ˆ ê°€ëŸ‰ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

10ë¶„ë™ì•ˆ ì‹¤í–‰í•˜ë„ë¡ ì§€ì‹œí–ˆì§€ë§Œ 03:10 ì— ë†’ì€ ì—ëŸ¬ìœ¨ë¡œ ì¸í•´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.

<img width="1013" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/08caf7f8-6cba-4a95-ae34-e2d2c4164cac">

### 5. ë‚´ì¥ tomcat ìµœì í™”

PR https://github.com/ghkdqhrbals/spring-chatting-server/pull/334 ì—ì„œ ì ìš©ëœ í†°ì¼“ ìµœì í™” ì„¤ì •ì„ ì•„ë˜ì— í’€ì–´ë³¼ê²Œìš”.

* ëŒ€ê¸° í í¬ê¸°(accept-count) 100 -> 100
    * ìœ ì§€
* ë™ì‹œ ì—°ê²° ê°œìˆ˜(max-connections) 100 -> 8192
    * í˜„ì¬ vuser 300 ì˜ ë™ì‹œ ì—°ê²° ìš”ì²­ì„ ì „ì†¡í•˜ê¸°ë•Œë¬¸ì— ì´ë¥¼ ê³ ë ¤í•˜ì—¬ default ê°œìˆ˜ê¹Œì§€ ì¦ëŸ‰
* ìµœëŒ€ ìŠ¤ë ˆë“œ í’€ í¬ê¸°(max-threads) 100 -> 150
    * ì±„íŒ…ì„œë²„ vcpu limit 1500m ì´ê¸°ë•Œë¬¸ì— ê° ì½”ì–´ë‹¹ * 100 í•˜ì—¬ ì²˜ë¦¬ 1.5 * 100 = 150
    * í˜„ì¬ ëŒ€ë¶€ë¶„ì˜ API ìš”ì²­ì—ì„œ i/o ì‘ì—…ì„ í•˜ê¸° ë•Œë¬¸ì— ì™ ë§Œí•˜ë©´ ìŠ¤ë ˆë“œë¥¼ ëŠ˜ë¦¬ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ë§Œì•½ cpu ì†Œëª¨ëŸ‰ì´ ë§ë‹¤ê³  í•œë‹¤ë©´ ì¤„ì´ëŠ” ê²ƒì´ ì¢‹ë‹¤ê³  í•©ë‹ˆë‹¤. ê´œí•œ context switch ë¥¼ ì¤„ì´ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
* ì—°ê²° íƒ€ì„ì•„ì›ƒ(connection-timeout) 10s -> 60s
    * í˜„ì¬ readinessProbe íƒ€ì„ì•„ì›ƒ ì„¤ì •ì´ 60s ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ì— ë§ì¶”ì–´ ì˜¤ë¥˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ 60s ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì˜¬ë°”ë¥´ë‹¤ê³  ìƒê°í•´ì„œ ë³€ê²½í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
* í•­ìƒ ìœ ì§€ë˜ëŠ” ìµœì†Œ ìŠ¤ë ˆë“œ í¬ê¸°(min-spare-threads) 30 -> 30
    * ìœ ì§€

ê·¸ë˜ì„œ ê²°ê³¼ëŠ”ìš”!!!

* Total Test : 181,050
* Success : 181,050
* Error : 0 (**0.0%**)
* AVG TPS : **308.4**
* MTTFB í‰ê· : 950.89 ms
* MTTFB ì°¨ì´ í‰ê·  : 112.52 ms
* MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): 10.67%

ì •ë§ ì‹ ê¸°í•˜ì§€ ì•Šë‚˜ìš”? **ë™ì‹œ ìš”ì²­ ìŠ¤ë ˆë“œ 300 ì„ ìš°ë¦¬ëŠ” ì—ëŸ¬ì—†ì´ ê²¬ë”œ ìˆ˜ ìˆëŠ” ì„œë²„ë¥¼ ë§Œë“¤ì–´ë‚¸ê±°ì—ìš”**! ê·¸ë¦¬ê³  MTTFB ê°€ ê½¤ ì•ˆì •ì ìœ¼ë¡œ ìˆ˜í‰ì„ ì´ë£¨ê³  ìˆëŠ” ë¶€ë¶„ì´ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ë¼ëŠ” ëœ»ì´ê² ì£ ? ì €ëŠ” ì´ ê²°ê³¼ë¥¼ í†µí•´ ë³‘ëª©ì´ ê±¸ë¦¬ëŠ” ê³³ì´ ë‚´ì¥ í†°ì¼“ì´ì˜€ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¼ ì´ì œ í˜„ì¬ê¹Œì§€ì˜ ëª¨ë“  í…ŒìŠ¤íŠ¸ë“¤ì„ ìš”ì•½í•˜ì—¬ ì‹œì‘ê³¼ ëì˜ ì„±ëŠ¥ì§€í‘œë¥¼ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤.

* HPA X, ë‹¨ì¼ íŒŒë“œ í†°ì¼“ ìµœì í™” ë¯¸ì ìš© ì±„íŒ… ì„œë²„ VUSER 300 ë¡œë“œí…ŒìŠ¤íŠ¸ ê²°ê³¼
  * Total Test : 40,228
  * Success : 19,668
  * Error : 20,560 (51.1%)
  * AVG TPS : 108.1
  * MTTFB í‰ê· : 1605.44 ms
  * MTTFB ì°¨ì´ í‰ê·  : 2838.38 ms
  * MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): 75.00%


* HPA O(max 3), ReadinessProbe O, CPU limit O, EKS NodeGroup AutoScaling O(CPU usage 50%), Caching, í†°ì¼“ ìµœì í™” O ì±„íŒ… ì„œë²„ VUSER 300  ë¡œë“œí…ŒìŠ¤íŠ¸ ê²°ê³¼
  * Total Test : 181,050
  * Success : 181,050
  * Error : 0 (**0.0%**)
  * AVG TPS : **308.4**
  * MTTFB í‰ê· : 950.89 ms
  * MTTFB ì°¨ì´ í‰ê·  : 112.52 ms
  * MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): 10.67%

* ê²°ê³¼ ë¹„êµ
    * ì—ëŸ¬ìœ¨ **51.1% -> 0.0 %** ë¡œ ì„œë²„ ì•ˆì „ì„± ì¦ê°€
    * TPS **108.1 -> 308.4** ë¡œ **185%** ì„±ëŠ¥ ì¦ê°€
    * MTTFB í‰ê·  **1605.44 ms -> 950.89 ms** ë¡œ **68%** ì„±ëŠ¥ ì¦ê°€
    * MTTFB ì°¨ì´ í‰ê·  **2838.38 ms -> 112.52 ms** ë¡œ **2433%** ì•ˆì „ì„± ì¦ê°€
  
  <img width="971" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/b1cda34a-4c3b-4d47-a3b7-79f588061e4c">
  <img width="969" alt="image" src="https://github.com/ghkdqhrbals/spring-chatting-server/assets/29156882/7761580e-5c65-4bc3-bea2-571934cc0f12">

### 6. ê²°ë¡ 
> âœ… ëŠ” ì£¼ìš” ê°œì„ ëœ ì§€í‘œë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤!

* ë‹¨ì¼ íŒŒë“œ ë°°í¬ ë° ìµœì í™” X
  * Total Test : 40,228
  * Success : 19,668
  * Error : 20,560 (51.1%)
  * AVG TPS : 108.1
  * MTTFB í‰ê· : 1605.44 ms
  * MTTFB ì°¨ì´ í‰ê·  : 2838.38 ms
* HPA ë¥¼ í†µí•œ íŒŒë“œ ì˜¤í†  ìŠ¤ì¼€ì¼ë§ ì ìš© ì‹œ ê²°ê³¼
  * Total Test : 142,805
  * Success : 133,416
  * Error : 9,389 (6.6%) âœ…
  * AVG TPS : 226.1 âœ…
  * MTTFB í‰ê· : 1265.08 ms âœ…
  * MTTFB ì°¨ì´ í‰ê·  : 1020.87 ms âœ…
* Readiness íƒ€ì„ì•„ì›ƒ 1ì´ˆ -> 10ì´ˆ
  * Total Test : 135,675
  * Success : 125,972
  * Error : 9,703 (7.1%) 
  * AVG TPS : 213.4 
  * MTTFB í‰ê· : 1296.50 ms 
  * MTTFB ì°¨ì´ í‰ê·  : 1166.17 ms
* Readiness íƒ€ì„ì•„ì›ƒ 10ì´ˆ -> 60ì´ˆ
  * Total Test : 138,487
  * Success : 138,462
  * Error : 25 (0.0%) âœ…
  * AVG TPS : 233.3
  * MTTFB í‰ê· : 1224.22 ms
  * MTTFB ì°¨ì´ í‰ê·  : 437.17 ms âœ…
* ë‚´ì¥ tomcat 10.1.7v max-threads í¬ê¸° 10ê°œ -> 100ê°œ
  * Total Test : 134,988
  * Success : 134,953
  * Error : 35 (0.0%)
  * AVG TPS : 228.4
  * MTTFB í‰ê· : 1249.87 ms
  * MTTFB ì°¨ì´ í‰ê·  : 350.82 ms âœ…
* ë‚´ì¥ tomcat ìµœì í™”
  * Total Test : 181,050
  * Success : 181,050
  * Error : 0 (0.0%)
  * AVG TPS : 308.4 âœ…
  * MTTFB í‰ê· : 950.89 ms âœ…
  * MTTFB ì°¨ì´ í‰ê·  : 112.52 ms âœ…

### Appendix - MTTFB í‰ê· ê³¼ ë³€ë™ëŸ‰, ë³€ë™ë¥  ì¸¡ì •í•˜ëŠ” python ì½”ë“œ

```python
import sys
import pandas as pd


def calculate_average_mttfb_difference(data):
    mttfb = data['Mean_time_to_first_byte']
    mttfb_differences = mttfb.diff().abs()[1:]  # ì²« ë²ˆì§¸ ê°’ì€ NaN ì´ë¯€ë¡œ ì œì™¸
    average_difference = mttfb_differences.mean()
    return average_difference

def calculate_total_weighted_mttfb_average(data):
    mttfb = data['Mean_time_to_first_byte']
    tests = data['Tests']
    total_weighted_mttfb = (mttfb * tests).sum()
    total_tests = tests.sum()
    weighted_average = total_weighted_mttfb / total_tests
    return weighted_average

def calculate_mttfb_variation(data):
    mttfb = data['Mean_time_to_first_byte']
    tests = data['Tests']

    mttfb_changes = mttfb.diff()[1:]
    mttfb_abs_percent_changes = (mttfb_changes / mttfb[:-1]).abs() * 100
    average_tests_weights = (tests[:-1] + tests[1:]) / 2
    weighted_avg_abs_changes = mttfb_abs_percent_changes * average_tests_weights[1:]
    average_weighted_avg_abs_change = weighted_avg_abs_changes.sum() / average_tests_weights[1:].sum()

    return average_weighted_avg_abs_change

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python script.py <path_to_csv_file>")
        sys.exit(1)

    csv_file_path = sys.argv[1]
    data = pd.read_csv(csv_file_path)

    weighted_average = calculate_total_weighted_mttfb_average(data)
    print(f"MTTFB í‰ê· : {weighted_average:.2f} ms")

    diff_average = calculate_average_mttfb_difference(data)
    print(f"MTTFB ì°¨ì´ í‰ê·  : {diff_average:.2f} ms")

    variation = calculate_mttfb_variation(data)
    print(f"MTTFB í‰ê· ì ì¸ ë³€ë™ë¥  (ì ˆëŒ€ê°’, ê°€ì¤‘ì¹˜ ì ìš©): {variation:.2f}%")
```