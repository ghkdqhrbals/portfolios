---
layout: default
title: 27. Spring Cloud ê¸°ë°˜ MSA ë³€í™˜ ì‹œì‘-2
parent: ğŸ“Œ ì‹¤ì‹œê°„ ì±„íŒ…ì„œë²„ í”„ë¡œì íŠ¸
nav_order: 27
---

created at 2023-03-28
{: .label .label-yellow }

# API GateWay ì„ ì •

![img](../../../assets/img/msa/proxy.png)

ê¸°ì¡´ì— ì €ëŠ” nginxë¥¼ ì•„ë˜ì˜ ì´ìœ ë¡œ ì‚¬ìš©í–ˆì–´ìš”.

1. í†µí•© ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸ë¥¼ ì œê³µ
2. ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ(ë°±ì—”ë“œ í¬ì¸íŠ¸ ìˆ¨ê¸°ê¸°)
3. ì„œë¹„ìŠ¤ ë³„ ë¡œë“œ ë°¸ëŸ°ì‹±
4. ë†’ì€ ë™ì‹œì²˜ë¦¬ì„±ëŠ¥

1,2,3 ë²ˆì€ ì¼ë°˜ì ì¸ Gateway íˆ´ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´êµ¬ìš”. NginxëŠ” 4ë²ˆì— íŠ¹í™”ëœ ë¶€ë¶„ì´ë¼ê³  ìƒê°í•´ì„œ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆì–´ìš”.
ë‹¤ë¥´ê²Œ ë§í•˜ë©´, ë†’ì€ ë™ì‹œì²˜ë¦¬ì„±ëŠ¥ì„ ë§Œì¡±ì‹œí‚¤ëŠ” Gateway ë¼ë©´ ì–´ë–¤ê²ƒì´ë“  ìƒê´€ì—†ì´ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.

ê·¸ëŸ¬ë˜ ì™€ì¤‘ Spring Cloud ì—ì„œëŠ” Netflix Zuul ê²Œì´íŠ¸ì›¨ì´ë¥¼ ë„·í”Œë¦­ìŠ¤ì—ì„œ ê¸°ë¶€ë°›ì•„ì„œ ì§€ì›í•˜ê³  ìˆë”ë¼êµ¬ìš”. ê·¸ë˜ì„œ ì œê°€ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” **ë™ì‹œì²˜ë¦¬ì„±ëŠ¥**ì—ì„œì˜ ì°¨ì´ë¥¼ ë¹„êµí•´ë³´ê¸° ìœ„í•´ì„œ ì•„ë˜ì˜ ì›ë¬¸ì„ ê°€ì ¸ì™€ë³´ì•˜ìŠµë‹ˆë‹¤. (reference : [https://instea.sk/2015/04/netflix-zuul-vs-nginx-performance/](https://instea.sk/2015/04/netflix-zuul-vs-nginx-performance/))

# API GateWay ì²˜ë¦¬ì„±ëŠ¥ë¹„êµ
### Via Nginx

```
Document Path: /sample.html
Document Length: 26650 bytes
 
Concurrency Level: 200
Time taken for tests: 52.366 seconds
Complete requests: 50000
Failed requests: 0
Total transferred: 1344700000 bytes
HTML transferred: 1332500000 bytes
Requests per second: 954.81 [#/sec] (mean)
Time per request: 209.465 [ms] (mean)
Time per request: 1.047 [ms] (mean, across all concurrent requests)
Transfer rate: 25076.93 [Kbytes/sec] received
 
Connection Times (ms)
 min mean[+/-sd] median max
Connect: 3 50 11.7 48 114
Processing: 37 159 11.9 160 208
Waiting: 36 159 11.9 160 207
Total: 40 209 10.4 209 256
 
Percentage of the requests served within a certain time (ms)
 50% 209
 66% 212
 75% 214
 80% 216
 90% 220
 95% 224
 98% 232
 99% 238
 100% 256 (longest request)
```

**Requests per second: 954.81 (#/sec)**

### Via Zuul

```
Document Path: /sodik/sample.html
Document Length: 26650 bytes
 
Concurrency Level: 200
Time taken for tests: 50.080 seconds
Complete requests: 50000
Failed requests: 0
Total transferred: 1343550000 bytes
HTML transferred: 1332500000 bytes
Requests per second: 998.39 [#/sec] (mean)
Time per request: 200.322 [ms] (mean)
Time per request: 1.002 [ms] (mean, across all concurrent requests)
Transfer rate: 26199.09 [Kbytes/sec] received
 
Connection Times (ms)
min mean[+/-sd] median max
Connect: 2 16 7.9 16 126
Processing: 15 184 108.1 203 1943
Waiting: 13 183 105.9 202 1934
Total: 18 200 107.8 218 1983
 
Percentage of the requests served within a certain time (ms)
50% 218
66% 228
75% 235
80% 239
90% 254
95% 287
98% 405
99% 450
100% 1983 (longest request)
```

**Requests per second: 998.39 (#/sec)**

ì¦‰, Nginx(954)ì™€ Zuul(998)ì€ ë™ì‹œì„±ëŠ¥(200-thread)ì—ì„œ ë¹„êµí–ˆì„ ë–„, í° ì°¨ì´ëŠ” ì—†ìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤!

# íŠ¸ëœë“œ ë¹„êµ

![img](../../../assets/img/msa/1.png)

í ... íŠ¸ëœë“œë¥¼ ë³´ì•˜ì„ ë•Œ nginxë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ê² ì§€ë§Œ, ì €ëŠ” ì´ì „ì— nginx.config ë§Œì§ˆ ë•Œ, ë„ˆë¬´ ë³µì¡í–ˆë˜ ê¸°ì–µì´ ìˆì–´ì„œ Spring-boot ë¡œ ì§ì ‘ ìˆ˜ì •ì´ ê°€ëŠ¥í•œ Zuul ì„ ì‚¬ìš©í•´ë³¼êº¼ì—ìš”. ê·¸ëŸ°ë° Zuulì€ í˜„ì¬ deprecate ë˜ì–´ì„œ Zuulì˜ ìœ ì§€ë¥¼ ì´ì–´ë°›ì€ **Spring-Cloud-Gateway** ë¥¼ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.
 
